# Thread safe

멀티 스레딩 환경에서 일반적으로 어떤 함수나 변수, 혹은 객체가 여러 스레드로부터 동시에 접근하더라도 프로그램의 실행에 문제가 없음을 의미한다. 즉, 하나의 함수가 한 스레드로부터 호출되어 실행 중일 때, 다른 스레드가 그 함수를 호출하여 동시에 실행하더라도 각 스레드에서의 함수의 수행 결과가 올바로 나오는 것이다.

## Thread-safe 를 보장하는 방법

### Re-entrancy

- 하나의 스레드가 함수를 실행하고 있을 때, 또 다른 스레드가 접근하여도 두 개의 스레드 모두 적절한 결과값을 반환해야 한다.

### Thread Local Storage

- 공유 자원의 사용을 지양한다.
  - 스레드 별로 관리하는 변수로 할당하여 독립적으로 사용하도록 한다.

### Immutable objects

- 공유 자원을 사용할 경우 불변 객체를 사용한다.

### Mutual exclusion

- 공유 자원을 사용해야 하는 경우 해당 자원의 접근을 세마포어와 같은 락으로 관리한다.
  - Java 의 synchronized

### Atomic operations

- 공유 자원에 접근할 때 원자적 연산을 이용하거나 '원자적' 으로 정의된 접근 방법을 사용함으로써 상호 배제를 구현한다.
  - 원자적 연산이란 중단되지 않는 연산을 의미하며 스레드가 절대 간섭할 수 없음이 보장된다.

## Java 환경 에서 Thread-safe 하게 설계하는 방법

- java.util.concurrent 패키지 하위의 클래스 사용
- 인스턴스 변수 지양
- 동기화 블럭(synchronized) 에서 연산 수행

### 참고 사이트
- https://sorjfkrh5078.tistory.com/267
